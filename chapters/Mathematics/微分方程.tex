
\chapter{微分方程}

\section{一阶微分方程}

\begin{displaymath}
\dfrac{dy}{dx} = f(ax + by + c)
\end{displaymath}
令u = ax + by + c，\begin{flalign}
    \dfrac{du}{dx} & = a + b\dfrac{dy}{dx} \nonumber \\ 
    \dfrac{du}{dx} & = a + bf(u) \nonumber
\end{flalign}


\subsection{齐次微分方程}
\[\dfrac{dy}{dx} = f(\dfrac{y}{x})\]
令\(u = \dfrac{y}{x}\), \(\dfrac{dy}{dx} = u + x\dfrac{du}{dx}\), 即
\[x\dfrac{du}{dx} + u = f(u)\]


\subsection{可化为齐次方程}

\[\dfrac{dy}{dx} = \dfrac{ax + by + c}{a_1x + b_1y + c_1}\]

\begin{itemize}
    \item 若\(\dfrac{a_1}{a} \neq \dfrac{b_1}{b}\)，令\[x = X + h, y = Y + k\]
    则\[dx = dX, dy = dY\]
    \[\dfrac{dY}{dX} = \dfrac{aX + bY + ah + bk + c}{a_1X + b_1Y + a_1h + b_1k + c_1}\]
    则可求出h，k使满足\(\begin{cases}
        ah + bk + c = 0 \\
        a_1h + b_1k + c_1 = 0
    \end{cases}\)，上式化为
    \[\dfrac{dY}{dX} = \dfrac{aX + bY}{a_1X + b_1Y}\]
    将\(X = x - h, Y = y - k\)代入得到通解；
    
    \item 若\(\dfrac{a_1}{a} == \dfrac{b_1}{b}\)，令\(\dfrac{a_1}{a} = \dfrac{b_1}{b} = \lambda\),则
    \[\dfrac{ax + by + c}{\lambda(ax + by) + c_1}\]
    令\(v = ax + by\),则\[\dfrac{1}{b}(\dfrac{dv}{dx} - a) = \dfrac{v + c}{\lambda v + c_1}\]
\end{itemize}


\subsection{一阶线性微分方程}
\[\dfrac{dy}{dx} + P(x)y = Q(x)\]
若\(Q(x) \equiv 0\), 则齐次, 若\(Q(x) \not\equiv 0\),则非齐次

\subsubsection{通解}
\begin{itemize}
    \item 齐次线性方程：\[y = Ce^{-\int_{}^{} P(x) \,dx}\]
    \item 非齐次线性方程：\[y = e^{-\int_{}^{} P(x) \,dx}(\int_{}^{}Q(x)e^{\int_{}^{}P(x) \,dx} \,dx + C)\]
\end{itemize}


\subsection{伯努利方程}
\[\dfrac{dy}{dx} + P(x)y = Q(x)y^{n}\space (n != 0, 1)\]
令\[z = y^{1 - n}\]
\[\dfrac{dz}{dx} = (1 - n)y^{-n}\dfrac{dy}{dx}\]
则上式化为\[\dfrac{dz}{dx} + (1 - n)P(x)z = (1 - n)Q(x)\]


\section{二阶可降解微分方程}

\subsection{\texorpdfstring{\(y'' = f(x, y')\)}{y''}}

令\(y' = p(x), y'' = p'(x)\)，则原方程为\[\dfrac{dp}{dx} = f(x, p)\]
若通解为\(p = F(x, C_1)\)，即\(y' = F(x, C_1)\)，则积分。


\subsection{\texorpdfstring{\(y'' = f(y, y')\)}{y''}}

令\(y' = p(y), y'' = \dfrac{dp}{dx} = p(y)\dfrac{dp}{dy}\)，则原方程为\[p\dfrac{dp}{dy} = f(y, p)\]
若通解为\(p = F(y, C_1)\)，则\(\int\dfrac{dy}{F(y, C_1)} = x + C_2\)

\subsection{\texorpdfstring{\(y'' = f(y')\)}{y''}}

既不显含y，也不显含x，按\(y'' = f(x, y')\)处理


\section{高阶线性微分方程}

\subsection{特征方程}
对n阶常系数齐次线性微分方程\[a_ny^{(n)} + ... + a_1y' + a_0y = 0\]
将\(y^{(k)}\)替换为\(r^k\)得\textbf{特征方程}\[a_nr^n + ... + a_1r + a_0 = 0\]
解特征方程得根\(r_1, ..., r_n\)；


\subsection{解的性质与结构}
\begin{itemize}
    \item 若解中含特解\(e^{rx}\)，则r至少为单实根；
    \item 若解中含特解\(x^{k - 1}e^{rx}\)，则r至少为k重实根；
    \item 若解中含特解\(e^{\alpha x}cos\beta x\)或\(e^{\alpha x}sin\beta x\)，则\(\alpha \pm \beta i\)至少为单复根；
    \item 若解中含特解\(e^{\alpha x}xcos\beta x\)或\(e^{\alpha x}xsin\beta x\)，则\(\alpha \pm \beta i\)至少为二重复根；
    
    \item 若\(y_1^*, y_2^*\)是非齐次方程的特解，则\(y_1^* - y_2^*\)是对应齐次方程的解；

    \item 若\(y_1^*\)是\(y'' + py' + qy = f_1(x)\)的解，\(y_2^*\)是\(y'' + py' + qy = f_2(x)\)的解，则\(y_1^* + y_2^*\)是\(y'' + py' + qy = f_1(x) + f_2(x)\)的解；

    \item 若\(y = C_1y_1(x) + C_2y_2(x)\)是\(y'' + py' + qy = 0\)的通解，\(y^*\)是\(y'' + py' + qy = f(x)\)的一个特解，则\(y + y^*\)是\(y'' + py' + qy = f(x)\)的特解；
\end{itemize}


\subsection{二阶常系数齐次线性微分方程}
\[y'' + py' + qy = 0\]

若\(y_1(x),y_2(x)\)是两个解，且\(\dfrac{y_1}{y_2} \neq C\)（C常数），则是线性无关解，通解为\[y(x) = C_1y_1(x) + C_2y_2(x)\]

\subsubsection{特征方程}
\(r^2 + pr + q = 0\)
\begin{itemize}
    \item \(p^2 - 4q > 0\)，则\(r_1 != r_2\)，通解\[y = C_1e^{r_1x} + C_2e^{r_2x}\]
    \item \(p^2 - 4q = 0\)，则\(r_1 = r_2 = r\)，通解\[y = (C_1 + C_2)e^{rx}\]
    \item \(p^2 - 4q < 0\)，则共轭复根\(\alpha \pm \beta i\)，通解\[y = (C_1cos\beta x + C_2sin\beta x)e^{\alpha x}\]
\end{itemize}


\subsection{二阶常系数非齐次线性微分方程}
\[y'' + py' + qy = f(x)\]


\paragraph{当\(f(x) = P_n(x)\)时}
特解为\[y^* = Q_n(x)x^k\]其中
\[\begin{cases}
    Q_n(x)\text{ 与P(x)同阶多项式，通常代入计算得到} \\
    k = \begin{cases}
        0, 0 \neq r_1,\ \ 0 \neq r_2 \\ 
        1, 0 = r_1\ \text{ or }\ 0 = r_2 \\ 
        2, 0 = r_1 = r_2
    \end{cases}
\end{cases}\]

\paragraph{当\(f(x) = P_n(x)e^{\alpha x}\)时}
特解设为
\[y^* = Q_n(x)x^ke^{\alpha x}\]其中
\[\begin{cases}
    e^{\alpha x}\text{ 照抄} \\
    Q_n(x)\text{ 与P(x)同阶多项式，通常代入计算得到} \\
    k = \begin{cases}
        0, \alpha \neq r_1,\ \ \alpha \neq r_2 \\ 
        1, \alpha = r_1\ \text{ or }\ \alpha = r_2 \\ 
        2, \alpha = r_1 = r_2
    \end{cases}
\end{cases}\]

\paragraph{当\(f(x) = [P_m(x)\cos\beta x + P_n(x)\sin\beta x]e^{\alpha x}\)时}
特解设为
\[y^* = [Q_l^1(x)cos\beta x + Q_l^2(x)sin\beta x]x^ke^{\alpha x}\]
其中
\[\begin{cases}
    e^{\alpha x}\text{ 照抄} \\ 
    l = max\{m, n\} \\ 
    k = \begin{cases}
        0, \alpha \pm \beta i \neq r_{1,2} \\ 
        1, \alpha \pm \beta i = r_{1,2}
    \end{cases}
\end{cases}\]


\section{n阶常系数齐次线性微分方程}
\[a_1r^n + a_2r^{n - 1} + ... + a_n = 0\]

根据特征方程得到特征根的值，根据特征根得到通解。


\section{欧拉方程(数一)}
\[x^2y'' + pxy' + qy = f(x)\]

当\(x > 0\)时，令\(x = e^t\)，则\(t = lnx, \dfrac{dt}{dx} = \dfrac{1}{x}\)，于是
\[\dfrac{dy}{dx} = \dfrac{dy}{dt} \dfrac{dt}{dx} = \dfrac{1}{x} \dfrac{dy}{dt}\]
\[\dfrac{d^2y}{dx^2} = \dfrac{d}{dx}(\dfrac{1}{x}\dfrac{dy}{dt}) = -\dfrac{1}{x^2}\dfrac{dy}{dt} + \dfrac{1}{x}\dfrac{d}{dx}(\dfrac{dy}{dt}) = -\dfrac{1}{x^2}\dfrac{dy}{dt} + \dfrac{1}{x^2}\dfrac{d^2y}{dt^2}\]
方程化为\[\dfrac{d^2y}{dt^2} + (p - 1)\dfrac{dy}{dt} + qy = f(e^t)\]

当\(x < 0\)时，令\(x = -e^t\)，同理


